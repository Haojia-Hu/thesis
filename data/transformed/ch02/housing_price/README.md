# Housing-Market Prices

This folder contains regression outputs for the Chapter 2 house price analysis using 2SLS.

## What this module does
We estimate 2SLS models of CBSA-level monthly house price growth on the local mortgage rate gap.
The endogenous regressor is `rate_gap`, instrumented by `Z_bartik`. All specifications include
CBSA fixed effects and month fixed effects, with standard errors clustered at the CBSA level.

In addition to the baseline 2SLS model, we run a set of robustness checks that vary the sample
and specification following the analysis script.

## Inputs (from data/transformed/ch02)
1. Zillow house prices (ZHVI)
- data/transformed/ch02/zillow/zillow_zhvi.csv
Used to construct monthly house price growth:
`price_chg = 100 * (log(ZHVI_t) - log(ZHVI_{t-1}))`.

2. Core CBSA-month panel (RateGap, IV, and controls)
- data/transformed/ch02/housing_quant/panel_rategap_hat.csv
Contains `rate_gap`, `Z_bartik`, and time-varying controls such as unemployment rate,
migration rate, and building permits.

3. Zillow housing quantity proxy (new listings)
- data/transformed/ch02/zillow/zillow_newlisting.csv
Used to construct a logged lock-in proxy (`proxy_newlist`), primarily for consistency
with the broader Chapter 2 data pipeline.

## Outputs
1. housing_price_2sls_baseline_and_robustness.csv
A tidy table that records the estimated 2SLS coefficient on `rate_gap` and key statistics
for:
- Baseline 2SLS
- Baseline + lagged dependent variable
- Trimmed sample (5–95 percentiles of rate gap) [as implemented in code]
- High-gap vs low-gap subsamples (split at the sample median) [as implemented in code]
- COVID vs hiking-period subsamples [as implemented in code]

2. housing_price_2sls_models.rds (optional)
Serialized `fixest` model objects for reproducibility and for producing LaTeX tables
without rerunning regressions.

## Reproducibility
These outputs are generated by:
- code/ch02/07_housing_price/01_price_2sls_robustness.R

---

## Additional transformed input for heterogeneity
 (Constructed Data)

The following transformed datasets are generated from raw external data
to support heterogeneity analysis in Chapter 2.

---
1) QCEW CBSA-Level Monthly Employment

Output file:
    QCEW_cbsa_totalemp.csv

Construction steps:
- Start from BLS QCEW quarterly county-level "singlefile" CSVs (2018–2024)
- Keep:
    own_code = 0 (all ownership)
    industry_code = 10 (total, all industries)
- Expand quarterly employment to monthly values
- Aggregate county-level employment to CBSA level
  using Census county-to-CBSA crosswalk (list1_2023.xlsx)

Resulting dataset:
    CBSA × Month employment totals

Key variables:
- cbsa_code
- year
- month
- ym (YYYY-MM)
- emp_total

This dataset is used to construct:
- employment_growth (month-over-month % change)
- CBSA-level average employment growth (for heterogeneity splits)

---
2) Saiz (2010) Housing Supply Elasticity – CBSA Version

Output file:
    saiz2010_cbsa.csv

Construction steps:
- Start from Saiz (2010) original dataset (MSA 1999 codes)
- Use MSA(1999) → CBSA(2003) crosswalk (cbsa03_msa99.xls)
- Map old MSA codes to modern CBSA codes
- Drop unmatched entries

Key variables:
- cbsa_code
- elasticity
- inv_elast = 1 / elasticity

Used for:
- High vs Low supply elasticity heterogeneity analysis
- Interaction analysis in dynamic LP-IV models

---

Reproducibility

These transformed files are generated by:

    thesis/code/ch02/07_housing_price/03 and 04
