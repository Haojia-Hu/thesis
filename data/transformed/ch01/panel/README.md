# Transformed Data: Panel Dataset

This folder contains the **analysis panel dataset** used as the main input for
Chapter 1 regressions (Local Projections, fixed-effects regressions, and robustness checks).

## File (Baseline)

- `panel_data.csv`  
  Monthly category-by-date panel covering **2004-02 to 2024-12** (inclusive).

### Construction script

Generated by:

- `code/ch01/03_expectation_formation/04_build_panel_data.R`  
  (repo version of the panel assembly script)

### Inputs (from transformed data)

The panel is assembled by merging the following transformed inputs:

1. **Attention (first-differenced)**
   - Category-level attention difference series (`diff_index`)
   - These are produced upstream and read directly by the panel script.

2. **Category CPI index (level)**
   - Monthly CPI index by category (`*_cpi.csv`)

3. **News volume (Factiva, monthly)**
   - Monthly news series per category (annual counts converted to monthly)

4. **Macro controls (level)**
   - Monthly macro series (e.g., RDI, ConsumerSent, Unemployment, EPU, CpiAgg, InflationExp, MortgageRate)

### Transformations performed at the panel stage

Important: In the current pipeline, the following transformations are performed
**inside the panel assembly script** (not in the upstream transformed inputs):

- Macro variables: first differences (`D_<var>`)
- CPI: price change and volatility construction, plus additional differencing
  - `PriceChange = CPI - lag(CPI)`
  - `Diff_PriceChange = PriceChange - lag(PriceChange)`
  - `PriceVolatility = rolling SD of CPI (3-month window)`
  - `Diff_Volatility = PriceVolatility - lag(PriceVolatility)`
- News: HP-filter detrending and first differences
  - `News_Cycle = HPfilter(news)`
  - `Diff_News = News_Cycle - lag(News_Cycle)`

### Columns (high level)

- `Date`: monthly date
- `category`: consumption category
- `diff_index`: first-differenced attention index (from upstream)
- `Diff_PriceChange`, `Diff_Volatility`: CPI-derived price measures
- `Diff_News`: detrended and differenced news measure
- `D_*`: differenced macro controls
